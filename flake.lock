{
  description = "Flake para expor o newm a partir de um repositório customizado";

  inputs = {
    nixpkgs.url = "github:NixOS/nixpkgs/nixos-23.11"; # base do sistema
    flake-utils.url = "github:numtide/flake-utils";    # utilitário de compatibilidade
    newm-src = {
      url = "github:jbuchermn/newm";                   # fonte original do newm
      flake = false;                                   # o repositório não é um flake
    };
  };

  outputs = { self, nixpkgs, flake-utils, newm-src, ... }:
    flake-utils.lib.eachDefaultSystem (system:
      let
        pkgs = import nixpkgs {
          inherit system;
        };
      in {
        packages.newm = pkgs.python3Packages.buildPythonPackage {
          pname = "newm";
          version = "unstable";
          src = newm-src;

          # Dependências do pyproject.toml do newm
          propagatedBuildInputs = with pkgs.python3Packages; [
            pywm
            setuptools
          ];

          # Desabilita testes (caso falhem ou precisem de display)
          doCheck = false;

          meta = {
            description = "Not Even a Window Manager";
            homepage = "https://github.com/jbuchermn/newm";
            license = pkgs.lib.licenses.mit;
          };
        };
      });
}
